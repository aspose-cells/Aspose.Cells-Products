---
title: Create Waterfall Chart in Microsoft Excel XLSX Files via C#
weight: 7700
description: C# sample code for adding a Waterfall chart to an XLSX workbook using Aspose.Cells for .NET. Use this code to generate Waterfall charts in Excel files within VB.NET, ASP.NET, or any .NET based application.
keywords: [C# Aspose.Cells, waterfal chart c#, create waterfall chart in xlsx, add waterfall chart c#, Aspose.Cells waterfall chart, generate waterfall chart, Excel waterfall chart .NET, C# Excel chart, Aspose.Cells chart examples, waterfal chart sample]
---

{{< blocks/products/pf/main-wrap-class isAutogenPage="true">}}
{{< blocks/products/pf/upper-banner h1="Create Waterfall Chart in XLSX Documents via C#" h2="Native and high performance Microsoft Excel XLSX spreadsheet with Waterfall chart creation programmatically using server side .NET APIs." logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/cells/aspose_cells-for-net.svg" sourceAdditionalConversionTag="" additionalConversionTag="XLSX" pfName="" subTitlepfName="" downloadUrl="" fileiconsmall1="HTML" fileiconsmall2="JPG" fileiconsmall3="PDF" fileiconsmall4="XML" fileiconsmall5="XLSX" >}}

{{< blocks/products/pf/main-container pfName="Aspose.Cells " subTitlepfName="for .NET" >}}
{{< blocks/products/pf/sub-menu autoGeneratedVersion="true" logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/cells/aspose_cells-for-net.svg" apiHomeLink="" codeSamplesLink="https://github.com/aspose-cells" liveDemosLink="https://products.aspose.app/cells/family" docsLink="https://docs.aspose.com/cells/net" installationsDocsLink="https://docs.aspose.com/cells/net" nugetLink="https://www.nuget.org/packages/aspose.cells" nugetPackageName="" downloadAsLink="https://downloads.aspose.com/cells/net" learnAsLink="https://docs.aspose.com/cells/net" apiReference="" mavenRepoLink="" >}}

{{% blocks/products/pf/agp/content h2="" %}}

Generating a Microsoft Excel XLSX file that contains a Waterfall chart dynamically within a running application is simple. To create XLSX documents with Waterfall charts from scratch—without requiring Microsoft Office—we will use **Aspose.Cells for .NET**. The API provides rich functionality for spreadsheet creation, manipulation, and visualization on any .NET platform.

{{% /blocks/products/pf/agp/content %}}

{{< blocks/products/pf/agp/feature-section isGrey="true" >}}

{{% blocks/products/pf/agp/feature-section-col title="How to create a Waterfall chart in XLSX via C#" %}}

{{% blocks/products/pf/agp/text %}}

A Waterfall chart helps visualize how an initial value is affected by a series of positive and negative values. With Aspose.Cells you can build such a chart in just a few lines of code.

{{% /blocks/products/pf/agp/text %}}

1. Include the Aspose.Cells namespace in your class file.  
2. Create an instance of the **Workbook** class.  
3. Access the first worksheet of the workbook.  
4. Populate the worksheet with the data that will be represented in the Waterfall chart.  
5. Add a Waterfall chart to the worksheet and bind it to the data range.  
6. Optionally customize the chart title, legend, and formatting.  
7. Save the workbook as an XLSX file.

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/feature-section-col title="System Requirements" %}}

{{% blocks/products/pf/agp/text %}}

Make sure the target system runs Microsoft Windows (or any OS supported by .NET Core/.NET 5+), has the .NET Framework / .NET Core / .NET 5+ installed, and a development environment such as Visual Studio.

- Install via NuGet: `nuget install Aspose.Cells` or in the Package Manager Console: `Install-Package Aspose.Cells`.  
- Alternatively, download the offline MSI installer or the ZIP containing all DLLs from the <a href="https://downloads.aspose.com/cells/net">Aspose.Cells .NET download page</a>.

{{% /blocks/products/pf/agp/text %}}

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/code-block title="Create Waterfall Chart in XLSX – C#" offSpacer="" %}}

```csharp
using System;
using Aspose.Cells;
using Aspose.Cells.Charts;

namespace WaterfallChartDemo
{
    class Program
    {
        static void Main()
        {
            // 1. Create a new workbook.
            Workbook workbook = new Workbook();

            // 2. Get the first worksheet.
            Worksheet sheet = workbook.Worksheets[0];

            // 3. Populate the worksheet with sample data.
            //    Column A – Category (e.g., "Start", "Sales", "Expenses", "Tax", "Profit")
            //    Column B – Value
            sheet.Cells["A1"].Value = "Category";
            sheet.Cells["B1"].Value = "Amount";

            sheet.Cells["A2"].Value = "Start";
            sheet.Cells["B2"].Value = 5000;

            sheet.Cells["A3"].Value = "Sales";
            sheet.Cells["B3"].Value = 8000;

            sheet.Cells["A4"].Value = "Expenses";
            sheet.Cells["B4"].Value = -2000;

            sheet.Cells["A5"].Value = "Tax";
            sheet.Cells["B5"].Value = -1500;

            sheet.Cells["A6"].Value = "Profit";
            sheet.Cells["B6"].Value = 0; // The Waterfall chart will calculate the final total automatically.

            // 4. Add a Waterfall chart.
            //    Parameters: chart type, upper‑left row, upper‑left column, lower‑right row, lower‑right column
            int chartIndex = sheet.Charts.Add(ChartType.Waterfall, 8, 0, 24, 10);
            Chart chart = sheet.Charts[chartIndex];

            // 5. Set the data source for the chart.
            //    Use the range A1:B6 (including headers).
            chart.NSeries.Add("=Sheet1!$B$2:$B$6", true);
            chart.NSeries.CategoryData = "=Sheet1!$A$2:$A$6";

            // 6. Optional: Customize the chart title.
            chart.Title.Text = "Quarterly Financial Waterfall";

            // 7. Optional: Show the chart legend.
            chart.ShowLegend = true;

            // 8. Save the workbook as an XLSX file.
            workbook.Save("WaterfallChartDemo.xlsx");
        }
    }
}
```

The code above creates a simple Waterfall chart that visualizes the flow from the **Start** value through **Sales**, **Expenses**, **Tax**, and finally calculates the **Profit** automatically.

{{% /blocks/products/pf/agp/code-block %}}

{{< /blocks/products/pf/agp/feature-section >}}

<!-- aboutfile Starts -->     
{{% blocks/products/pf/agp/content h2="" %}}

Aspose.Cells for .NET is a powerful spreadsheet programming library capable of building cross‑platform applications. It enables developers to generate, modify, convert, render, and print Excel XLSX files. In addition to chart creation, the API supports conversion to PDF, HTML, images, ODS, and many other formats—making it ideal for enterprise‑grade document processing.

{{% /blocks/products/pf/agp/content %}}

{{< blocks/products/pf/agp/about-file-section >}}

{{< blocks/products/pf/agp/about-file-text fileFormat="XLSX" readMoreLink="https://docs.fileformat.com/spreadsheet/xlsx/" >}}

XLSX is the modern Open XML workbook format introduced with Microsoft Office 2007. It is a ZIP package that contains a collection of XML files describing worksheets, charts, styles, and other workbook components. Aspose.Cells works directly with the XLSX package, allowing full‑fidelity creation and manipulation without the need for Microsoft Office.

{{< /blocks/products/pf/agp/about-file-text >}}

{{< /blocks/products/pf/agp/about-file-section >}}
<!-- aboutfile Ends -->

{{< blocks/products/pf/agp/other-supported-section title="Other Supported Waterfall Chart Formats" subTitle="You can also create Waterfall charts in other Microsoft Excel formats listed below." >}}

{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/waterfall-to-xls/" name="XLS" description="Microsoft Excel Spreadsheet (Legacy)" >}} 
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/waterfall-to-xlsx/" name="XLSX" description="Open XML Workbook" >}}
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/waterfall-to-xlsb/" name="XLSB" description="Excel Binary Workbook" >}}
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/waterfall-to-xlsm/" name="XLSM" description="Macro‑enabled Spreadsheet" >}} 

{{< /blocks/products/pf/agp/other-supported-section >}}

{{< /blocks/products/pf/main-container >}}
    
{{< /blocks/products/pf/main-wrap-class >}}