---
title: Create Treemap Chart in XLSX Documents via C#
weight: 7835

description: C# sample code for creating a Treemap chart in an XLSX workbook using Aspose.Cells for .NET. Use this guide to add Treemap visualisations to Excel files programmatically in any .NET application.
keywords: [C# Aspose.Cells, create Treemap chart in XLSX, add Treemap chart C#, Aspose.Cells Treemap, C# generate chart Excel, C# Excel Treemap, Aspose.Cells chart examples, C# spreadsheet chart, Treemap chart .NET, Excel visualization C#]
---

{{< blocks/products/pf/main-wrap-class isAutogenPage="true">}}
{{< blocks/products/pf/upper-banner h1="Create Treemap Chart in XLSX Documents via C#" h2="Programmatically generate interactive Treemap charts in Microsoft Excel XLSX files using high‑performance Aspose.Cells for .NET APIs." logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/cells/aspose_cells-for-net.svg" sourceAdditionalConversionTag="" additionalConversionTag="XLSX" pfName="" subTitlepfName="" downloadUrl="" fileiconsmall1="HTML" fileiconsmall2="JPG" fileiconsmall3="PDF" fileiconsmall4="XML" fileiconsmall5="XLSX" >}}

{{< blocks/products/pf/main-container pfName="Aspose.Cells " subTitlepfName="for .NET" >}}
{{< blocks/products/pf/sub-menu autoGeneratedVersion="true" logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/cells/aspose_cells-for-net.svg" apiHomeLink="" codeSamplesLink="https://github.com/aspose-cells" liveDemosLink="https://products.aspose.app/cells/family" docsLink="https://docs.aspose.com/cells/net" installationsDocsLink="https://docs.aspose.com/cells/net" nugetLink="https://www.nuget.org/packages/aspose.cells" nugetPackageName="" downloadAsLink="https://downloads.aspose.com/cells/net" learnAsLink="https://docs.aspose.com/cells/net" apiReference="" mavenRepoLink="" >}}

{{% blocks/products/pf/agp/content h2="" %}}

Generating a **Treemap chart** inside an Excel workbook programmatically is straightforward with Aspose.Cells for .NET. The library does not require Microsoft Office on the server, yet it lets you create rich, hierarchical visualisations that are fully compatible with Excel 2013 and later.

{{% /blocks/products/pf/agp/content %}}

{{< blocks/products/pf/agp/feature-section isGrey="true" >}}

{{% blocks/products/pf/agp/feature-section-col title="How to create a Treemap chart in XLSX via C#" %}}

{{% blocks/products/pf/agp/text %}}

The following steps walk you through creating a Treemap chart from scratch:

1. Include the required namespaces.
2. Instantiate a `Workbook` object.
3. Populate the worksheet with hierarchical data.
4. Add a chart of type **Treemap**.
5. Set the data source, chart title, and visual style.
6. Save the workbook as an XLSX file.

{{% /blocks/products/pf/agp/text %}}

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/feature-section-col title="System Requirements" %}}

{{% blocks/products/pf/agp/text %}}

A .NET development environment (Visual Studio, Rider, or VS Code) with **.NET Framework 4.6+**, **.NET Core 2.1+**, **.NET 5/6/7**, or **Mono** is sufficient. The library works on Windows, Linux, and macOS.

- Install via NuGet: `nuget install Aspose.Cells` or `Install-Package Aspose.Cells`.
- Or download the offline MSI/ZIP from the <a href="https://downloads.aspose.com/cells/net">Aspose.Cells .NET download page</a>.

{{% /blocks/products/pf/agp/text %}}

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/code-block title="Create Treemap Chart in XLSX – C#" offSpacer="" %}}

```cs
using System;
using Aspose.Cells;
using Aspose.Cells.Charts;

namespace TreemapChartDemo
{
    class Program
    {
        static void Main()
        {
            // 1. Create a new workbook.
            Workbook workbook = new Workbook();

            // 2. Access the first worksheet.
            Worksheet sheet = workbook.Worksheets[0];
            Cells cells = sheet.Cells;

            // ---------------------------------------------------------
            // 3. Populate sample hierarchical data.
            // ---------------------------------------------------------
            // Header row
            cells["A1"].PutValue("Region");
            cells["B1"].PutValue("Category");
            cells["C1"].PutValue("Sales");

            // Data rows
            string[,] data = new string[,]
            {
                { "North America", "Technology",   "1200" },
                { "North America", "Furniture",    "800"  },
                { "Europe",        "Technology",   "950"  },
                { "Europe",        "Furniture",    "650"  },
                { "Asia",          "Technology",   "1100" },
                { "Asia",          "Furniture",    "700"  }
            };

            // Write data to the worksheet.
            for (int i = 0; i < data.GetLength(0); i++)
            {
                cells[i + 1, 0].PutValue(data[i, 0]); // Region
                cells[i + 1, 1].PutValue(data[i, 1]); // Category
                cells[i + 1, 2].PutValue(double.Parse(data[i, 2])); // Sales
            }

            // ---------------------------------------------------------
            // 4. Add a Treemap chart to the worksheet.
            // ---------------------------------------------------------
            int chartIndex = sheet.Charts.Add(ChartType.Treemap, 5, 0, 25, 8);
            Chart treemap = sheet.Charts[chartIndex];

            // 5. Set the data range for the Treemap.
            //    The first column (Region) becomes the first hierarchy level,
            //    the second column (Category) the second level,
            //    and the third column (Sales) provides the size/value.
            string dataRange = "Sheet1!$A$1:$C$7";
            treemap.NSeries.Add(dataRange, true);

            // Set chart title.
            treemap.Title.Text = "Regional Sales Treemap";

            // Optional: Apply a built‑in chart style.
            treemap.Style = 13; // Style number varies from 1‑16

            // ---------------------------------------------------------
            // 6. Save the workbook.
            // ---------------------------------------------------------
            workbook.Save("TreemapChartDemo.xlsx");
            Console.WriteLine("Treemap chart created successfully.");
        }
    }
}
```

{{% /blocks/products/pf/agp/code-block %}}

{{< /blocks/products/pf/agp/feature-section >}}

<!-- aboutfile Starts -->     
{{% blocks/products/pf/agp/content h2="" %}}

Aspose.Cells for .NET is a powerful spreadsheet processing library that enables developers to **create, modify, convert and render** Excel files without Microsoft Office. It supports every Excel feature, including the newest chart types such as Treemap, Sunburst, and Waterfall, making it ideal for modern data‑visualisation scenarios.

{{% /blocks/products/pf/agp/content %}}

{{< blocks/products/pf/agp/about-file-section >}}

{{< blocks/products/pf/agp/about-file-text fileFormat="XLSX" readMoreLink="https://docs.fileformat.com/spreadsheet/xlsx/" >}}

XLSX is the default file format for Microsoft Excel 2007 and later. It stores workbook data in a compressed Open XML package, which is fully supported by Aspose.Cells, ensuring that charts, formulas, and formatting are preserved when generating files on the server.

{{< /blocks/products/pf/agp/about-file-text >}}

{{< /blocks/products/pf/agp/about-file-section >}}
<!-- aboutfile Ends -->

{{< blocks/products/pf/agp/other-supported-section title="Other Supported Chart Types" subTitle="Aspose.Cells can generate a wide variety of Excel chart types, including but not limited to the following:" >}}

{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/insert-clustered-column-chart/" name="Clustered Column" description="Standard column chart" >}} 
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/insert-pie-chart/" name="Pie" description="Pie chart for proportion data" >}}
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/insert-waterfall-chart/" name="Waterfall" description="Waterfall chart for financial analysis" >}}
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/insert-sunburst-chart/" name="Sunburst" description="Sunburst chart for hierarchical data" >}}
{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/cells/net/chart/insert-treemap-chart/" name="Treemap" description="Treemap chart for hierarchical data visualisation" >}}

{{< /blocks/products/pf/agp/other-supported-section >}}

{{< /blocks/products/pf/main-container >}}
    
{{< /blocks/products/pf/main-wrap-class >}}